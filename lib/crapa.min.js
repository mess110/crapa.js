!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("crapa",[],n):"object"==typeof exports?exports.crapa=n():e.crapa=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=2)}([function(e,n,t){"use strict";function r(){var e,n,t,r=navigator.appVersion,o=navigator.userAgent,a=navigator.appName,s=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10),u="Unknown OS",c=navigator.userAgent.replace(/[\(\)\,]/g,"").split(" ").map(function(e){return e.split("/")}),l=[].concat.apply([],c);return-1!==(n=o.indexOf("Opera"))?(a="Opera",s=o.substring(n+6),-1!==(n=o.indexOf("Version"))&&(s=o.substring(n+8))):-1!==(n=o.indexOf("MSIE"))?(a="Microsoft Internet Explorer",s=o.substring(n+5)):-1!==(n=o.indexOf("Chrome"))?(a="Chrome",s=o.substring(n+7)):-1!==(n=o.indexOf("Safari"))?(a="Safari",s=o.substring(n+7),-1!==(n=o.indexOf("Version"))&&(s=o.substring(n+8))):-1!==(n=o.indexOf("Firefox"))?(a="Firefox",s=o.substring(n+8)):(e=o.lastIndexOf(" ")+1)<(n=o.lastIndexOf("/"))&&(a=o.substring(e,n),s=o.substring(n+1),a.toLowerCase()===a.toUpperCase()&&(a=navigator.appName)),-1!==(t=s.indexOf(";"))&&(s=s.substring(0,t)),-1!==(t=s.indexOf(" "))&&(s=s.substring(0,t)),i=parseInt(""+s,10),isNaN(i)&&(s=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),-1!==r.indexOf("Win")&&(u="Windows"),-1!==r.indexOf("Mac")&&(u="MacOS"),-1!==r.indexOf("X11")&&(u="UNIX"),-1!==r.indexOf("Linux")&&(u="Linux"),{browserName:a,fullVersion:s,majorVersion:i,appName:navigator.appName,userAgent:navigator.userAgent,userAgentArray:l,os:u}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r,e.exports=n.default},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),a="https://json.northpole.ro/",s=function(){function e(){r(this,e)}return o(e,null,[{key:"genericRequest",value:function(e,n,t,r,o){var a;if(null==o&&(o=r),null==r)throw new Error("responseHandler function missing");a=new XMLHttpRequest,a.open(n,this.BASE_URL+t+".json",!0),a.onreadystatechange=function(){4===a.readyState&&(200===a.status?r(JSON.parse(a.responseText),a.status):o(JSON.parse(a.responseText),a.status))},a.send(JSON.stringify(e))}},{key:"createUser",value:function(e,n,t,r){var o;o={api_key:e,secret:n},this.genericRequest(o,"POST","user",t,r)}},{key:"getUser",value:function(e,n,t){this.genericRequest(e,"SEARCH","user",n,t)}},{key:"createStorage",value:function(e,n,t){this.genericRequest(e,"POST","storage",n,t)}},{key:"getStorage",value:function(e,n,t){this.genericRequest(e,"SEARCH","storage",n,t)}},{key:"putStorage",value:function(e,n,t){this.genericRequest(e,"PUT","storage",n,t)}},{key:"deleteStorage",value:function(e,n,t){this.genericRequest(e,"DELETE","storage",n,t)}},{key:"getNewRealtimeSocket",value:function(e,n){var t,r;return null==n&&(n=e),r=this.BASE_URL.replace("http","ws"),t=new WebSocket(r+"realtime"),t.onmessage=e,t.onclose=n,t}},{key:"subscribe",value:function(e,n){return e.send(JSON.stringify({type:"subscribe",channel_name:n}))}},{key:"unsubscribe",value:function(e,n){return e.send(JSON.stringify({type:"unsubscribe",channel_name:n}))}},{key:"publish",value:function(e,n,t){return e.send(JSON.stringify({type:"publish",channel_name:n,content:t}))}},{key:"BASE_URL",get:function(){return a},set:function(e){a=e}},{key:"help",get:function(){return"\nNorthPole JS wrapper example usage:\n\nresponseHandler = function (data) {\n  console.log(data);\n};\n\njNorthPole.getStorage(json, responseHandler);\n\nsocket = jNorthPole.getNewRealtimeSocket(responseHandler)\njNorthPole.subscribe(socket, 'foo')\njNorthPole.publish(socket, 'foo', { message: 'hello' })\n"}}]),e}();n.default=s,e.exports=n.default},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){p.default.BASE_URL=e}function a(e){return e.browser=(0,l.default)(),e.api_key=d,e.secret=y,e.type="error",p.default.createStorage(e,function(e){console.log(e)}),e}function s(){if(!0===g)return void console.warn("crapa listener already attached");g=!0,window.addEventListener("error",function(e){return a({error:{filename:e.filename,message:e.message,stack:e.error.stack,type:e.type,timeStamp:e.timeStamp,lineno:e.lineno,colno:e.colno}}),!1})}function i(e,n){d=e,y=n,s()}function u(e,n){try{p.default.createUser(e,n,function(e){console.log(e)})}catch(e){console.error(e)}i(e,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.setBaseUrl=n.register=n.init=void 0;var c=t(0),l=r(c),f=t(1),p=r(f),g=!1,d="guest",y="guest";n.init=i,n.register=u,n.setBaseUrl=o}])});